function doPost(e) {
  // フォームデータを取得
  var registrationNumber = e.parameter.registrationNumber;
  var name = e.parameter.name;
  var workplace = e.parameter.workplace;
  var employmentDate = e.parameter.employmentDate;

  // ステップ 1: 就業希望日が有効な日付かどうかをチェック
  var parsedDate = new Date(employmentDate);
  if (isNaN(parsedDate.getTime())) {
    // 無効な日付の場合、エラーメッセージを返す
    return ContentService.createTextOutput("無効な日付が入力されました。正しい形式で入力してください（例: 2025-03-01）。");
  }

  // ステップ 2: 受取日を現在の日付に設定
  var receiveDate = new Date();  // スタッフがフォームを送信した日を受取日として記録

  // スプレッドシートの設定
  var sheet = SpreadsheetApp.openById("1uG0Hw1My5M0NrKEpYgJY4jESsKJHsdrN1XmM7ZmVNmw").getSheetByName("Sheet1");

  // スプレッドシートにデータを追加（受取日を含めて）
  sheet.appendRow([registrationNumber, name, workplace, employmentDate, receiveDate]);

  // レスポンスを返す
  return ContentService.createTextOutput("データが送信されました！");
}
